<!DOCTYPE html>
<html style="height: 100%">

<head>
    <meta charset="utf-8">
    <style>
        body {
            font-family: "SF Pro Display", Roboto, Noto, Arial, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", sans-serif;
        }

        .title {
            width: 1000px;
            height: 50px;
            margin-bottom: 40px;
            display: inline-block;
            text-align: center;
            font-weight: 700;
            font-size: 28px;
        }

        .thisStatus {
            margin-bottom: 10px;
            font-weight: 700;
        }

        .desc-container {
            width: 1000px;
            display: flex;
        }

        .left-container,
        .right-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 10px;
        }

        .left-container>span,
        .right-container>span {
            display: inline-block;
            width: 180px;
            margin-bottom: 5px;
            color: #ffffff;
        }

        .left-container {
            background: #f98c58
        }

        .right-container {
            background: #3e8214
        }
    </style>
</head>

<body style="width: 1000px;height: 500px; margin: 0;padding: 20px;">
    <div class='title'>
        您的驾驶状态：
        <span>正常驾驶</span>
    </div>
    <div id="container" style="height: 500px;"></div>
    <div class="thisStatus">您的当前状态：</div>
    <div class="desc-container">
    
    </div>
    <script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>
    <script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts/echarts.min.js"></script>
    <script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts-gl/echarts-gl.min.js"></script>
    <script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts-stat/ecStat.min.js"></script>
    <script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts/extension/dataTool.min.js"></script>
    <script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts/map/js/china.js"></script>
    <script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts/map/js/world.js"></script>
    <script type="text/javascript" src="http://api.map.baidu.com/api?v=2.0&ak=ZUONbpqGBsYGXNIYHicvbAbM"></script>
    <script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts/extension/bmap.min.js"></script>
    <script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/simplex.js"></script>
    <script type="text/javascript">
        $(function () {
            getStatus();
            var self = setInterval(getStatus, 10000);

            function getStatus(params) {
                var person = {}
                var statusList = []
                var rateList = []
                var bloodList = []
                var timeList = []
                $.ajax({
                    type: "GET",
                    url: "http://localhost:5757/statusDetail",
                    data: {},
                    dataType: "json",
                    async: false,
                    success: function (data) {
                        var arr = data.data.statusList
                        var person = arr[0]
                        arr.forEach(function (item) {
                            rateList.push(item.rate)
                            bloodList.push(item.blood)
                            var newdate = new Date(item.time)
                            var date = newdate.getHours() + ':' + newdate.getMinutes() + ':' + newdate.getSeconds()
                            timeList.push(date)
                        });
                        var html = `
                            <div class="left-container">
                                <span>体重：
                                    <span>${person.weight}(kg)</span>
                                </span>
                                <span>心率：
                                    <span>${person.rate}pm(正常)</span>
                                </span>
                                <span>血氧浓度：
                                    <span>${person.blood}%(偏低)</span>
                                </span>
                            </div>
                            <div class="right-container">
                                <span>性别：
                                    <span>男</span>
                                </span>
                                <span>年龄：
                                    <span>${person.age}岁</span>
                                </span>
                                <span>身高：
                                    <span>${person.height}cm</span>
                                </span>
                            </div>
                        `
                        $('.desc-container').empty()
                        $('.desc-container').append(html)
                        console.log(person, rateList, bloodList, timeList)
                    }
                })
                var dom = document.getElementById("container");
                var myChart = echarts.init(dom);
                var app = {};
                option = null;
                option = {
                    title: {
                        text: '您的最近一周驾驶状态',
                        subtext: ''
                    },
                    tooltip: {
                        trigger: 'axis'
                    },
                    legend: {
                        data: ['心率', '血氧浓度']
                    },
                    toolbox: {
                        show: true,
                        feature: {
                            dataZoom: {
                                yAxisIndex: 'none'
                            },
                            dataView: {
                                readOnly: false
                            },
                            magicType: {
                                type: ['line', 'bar']
                            },
                            restore: {},
                            saveAsImage: {}
                        }
                    },
                    xAxis: {
                        type: 'category',
                        boundaryGap: false,
                        data: timeList
                    },
                    yAxis: {
                        type: 'value',
                        axisLabel: {
                            formatter: '{value}'
                        }
                    },
                    series: [{
                        name: '心率',
                        type: 'line',
                        data: rateList,
                        markPoint: {
                            data: [{
                                type: 'max',
                                name: '最大值'
                            }, {
                                type: 'min',
                                name: '最小值'
                            }]
                        },
                        markLine: {
                            data: [{
                                type: 'average',
                                name: '平均值'
                            }]
                        }
                    }, {
                        name: '血氧浓度',
                        type: 'line',
                        data: bloodList,
                        markPoint: {
                            data: [{
                                name: '周最低',
                                value: -2,
                                xAxis: 1,
                                yAxis: -1.5
                            }]
                        },
                        markLine: {
                            data: [{
                                    type: 'average',
                                    name: '平均值'
                                },
                                [{
                                    symbol: 'none',
                                    x: '90%',
                                    yAxis: 'max'
                                }, {
                                    symbol: 'circle',
                                    label: {
                                        normal: {
                                            position: 'start',
                                            formatter: '最大值'
                                        }
                                    },
                                    type: 'max',
                                    name: '最高点'
                                }]
                            ]
                        }
                    }]
                };
                if (option && typeof option === "object") {
                    myChart.setOption(option,
                        true);
                }
            };

        })
    </script>
</body>

</html>